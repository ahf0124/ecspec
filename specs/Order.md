# 注文フロー
①カートイン後、商品と数量の確認②会員を識別し、会員情報があればログイン、なければ新規登録かゲスト購入の選択
③配送先や方法の選択、④支払い方法の選択、⑤値引き、キャンペーン、ポイント、⑥上記に含まれないオプションの選択を行う。それぞれに多様な要件がある。

## ①カートイン
- カートインのタイミングで料金の計算や配達日指定のルールなどが決めることもあり、行う処理は多い。
- 商品展開し、商品と数量の確認を行う。
- 販売可能数をチェックする。
- 付与キャンペーン在庫チェックをチェックする
- 商品販売パターンをチェックする。
- 同じカートに同梱不可能な商品(同時購入不能な商品、例えば常温商品と冷凍商品)をチェックする。


## ②会員か、ゲスト購入か
- 会員については以下を参照。
- [会員について](https://github.com/commerble/ecspec/blob/master/specs/Member.md)
- 会員IDはどこで管理するか、自社ECか、それ以外のIdp(アイデンティティ・プロバイダ)か。
- 購入には会員登録が必須か、ゲスト購入も可能とするか。
- ゲスト購入後に会員登録するような仕様を設けるかなどが検討事項として存在する。

## ③配送先や方法の選択(送料)
- 配送先の新規設定もしくは登録済みの住所から選択する。

### 送料
- 送料は、送料は地域や都道府県や郵便番号別に異なるか、離島に対応しているか
- その他のやり方として、離島は通販基幹で注文を止め(特定の郵便番号で検知)、再計算し、顧客に提示する方法を取ることもある。家具などサイズの大きい商品を多く扱っていて配送料の金額が高い場合は、このような手法を取ることが多い。

### 店舗受取
- 店舗受取する場合は、受取店舗の選択を行う。


## ④支払い方法
支払い方法については別ページを参照。
- [支払い方法について](https://github.com/commerble/ecspec/blob/master/specs/Payment.md)


## ⑤値引き、キャンペーン、ポイント
値引きにはいろいろな方法があるが、キャンペーンという考え方でまとめる。
値引きの種類には下記のようなものが該当する。

- ボリュームディスカウント＝N点以上買うとM円引き。
- 定率引き、定額引き。
- ポイント付与倍率の変更。
- それぞれ、小数点以下をどうするか調整が必要。


### クーポン
- クーポンは上記キャンペーンを発動させるためにクーポンコードを入れるというような利用形式が多い。
クーポンで値引きをするという考え方よりは、クーポンでキャンペーン(値引き)を発動するような形の方が、しっくりとくる。


## ポイント
- ポイントをどこで管理するか。ポイントについてはEC単独で持つケース、店舗と共通にするためPOS側(基幹側)でポイントを持っていることもある。
- ポイントの利用用途は、利用ポイントは 1pt = 1円で、1pt から購入商品金額・送料の支払に使える
など使い方を定義する必要がある。
他にポイントについて決めるべき仕様は以下のような点がある。
- ポイントはいつ付与されるか(出荷時もしくは、返品がなくなる出荷２週間後などが多いかもしれない)
- ポイントはいつ失効するか(１年後、最終購入から１年後、失効しない等)
- 付与ポイントの算出方法に関して計算式を用意する必要がある。
- 経理上の処理、法的制限がないか確認する。
- ポイント利用ができない商品があるか検討する。


## ⑥オプション
オプションについては様々な選択肢があるので、利用したケースを記載していく。

### オプション(ギフト梱包)
- ギフト梱包はECでは一般的となっている。有料のもの無料のもの。
- ギフト梱包はすべての商品で有効か、特定商品では使えないなどがある。
- ギフト梱包はクリスマスや父の日など特定の日付近にのみ有効なものも存在する。

### オプション(裾上げ)
- 裾上げ

### オプション(建材EC例)
- 荷受け担当者、出荷証明書有無、搬入制限

